1. Table Creation

CREATE TABLE O_Roll_Call (
    roll_no INT PRIMARY KEY,
    name VARCHAR(50),
    class VARCHAR(20)
);

CREATE TABLE N_Roll_Call (
    roll_no INT PRIMARY KEY,
    name VARCHAR(50),
    class VARCHAR(20)
);

2. Sample Data

INSERT INTO O_Roll_Call VALUES
(1, 'Ravi', 'FY'),
(2, 'Sneha', 'SY'),
(3, 'Amit', 'TY');

INSERT INTO N_Roll_Call VALUES
(2, 'Sneha', 'SY'),  -- already exists
(3, 'Amit', 'TY'),   -- already exists
(4, 'Priya', 'FY'),  -- new
(5, 'Rohan', 'SY');  -- new

3. PL/SQL / MySQL Stored Procedure Using Parameterized Cursor

DELIMITER $$

CREATE PROCEDURE merge_roll_call()
BEGIN
    DECLARE v_roll INT;
    DECLARE v_name VARCHAR(50);
    DECLARE v_class VARCHAR(20);
    DECLARE done INT DEFAULT 0;

    -- Cursor to iterate through N_Roll_Call
    DECLARE cur1 CURSOR FOR SELECT roll_no, name, class FROM N_Roll_Call;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

    OPEN cur1;

    read_loop: LOOP
        FETCH cur1 INTO v_roll, v_name, v_class;
        IF done THEN
            LEAVE read_loop;
        END IF;

        -- Check if roll number already exists in O_Roll_Call
        IF (SELECT COUNT(*) FROM O_Roll_Call WHERE roll_no = v_roll) = 0 THEN
            INSERT INTO O_Roll_Call VALUES (v_roll, v_name, v_class);
        END IF;
    END LOOP;

    CLOSE cur1;
END$$

DELIMITER ;

4. Execute the Procedure

CALL merge_roll_call();

5. Verify the Merged Data

SELECT * FROM O_Roll_Call;

